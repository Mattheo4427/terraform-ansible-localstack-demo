---
- name: Seed LocalStack DynamoDB
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Add sample todo items
      shell: |
        aws dynamodb put-item \
          --table-name todo \
          --item '{"id": {"S": "{{ item.id }}"}, "title": {"S": "{{ item.title }}"}, "done": {"BOOL": false}}' \
          --endpoint-url http://localstack:4566 \
          --region us-east-1
      loop:
        - { id: "1", title: "Task 1 seeded" }
        - { id: "2", title: "Task 2 seeded" }
        - { id: "3", title: "Task 3 seeded" }
      environment:
        AWS_ACCESS_KEY_ID: test
        AWS_SECRET_ACCESS_KEY: test